import"./chunk-PYL45D43.js";import{a as y}from"./chunk-AKWIFSH2.js";import{c as K,d as _}from"./chunk-VP6CFJRX.js";import{A as r,Aa as A,B as n,C as c,D as R,E as g,F as h,H as o,I as l,N as D,U as k,V as j,W as S,Z as T,ea as O,fa as w,ga as G,ha as V,ia as B,ka as q,na as P,o as f,q as M,r as L,ra as $,s as m,t as p,ta as z,u as v,v as b,va as H,w as s,xa as J,y as d,ya as C}from"./chunk-Y3NWWHFQ.js";var Z=e=>["/departments/edit",e];function ee(e,i){e&1&&c(0,"span",14)}function te(e,i){e&1&&(r(0,"span"),o(1,"Delete"),n())}function ie(e,i){if(e&1){let t=R();r(0,"tr")(1,"td"),o(2),n(),r(3,"td"),o(4),n(),r(5,"td"),o(6),n(),r(7,"td",9)(8,"a",11),o(9,"Edit"),n(),r(10,"button",12),g("click",function(){let I=M(t).$implicit,F=h();return L(F.deleteDepartment(I.id))}),s(11,ee,1,0,"span",13)(12,te,2,0,"span",8),n()()()}if(e&2){let t=i.$implicit;m(2),l(t.name),m(2),l(t.description),m(2),l(t.employeeCount||0),m(2),d("routerLink",D(7,Z,t.id)),m(2),d("disabled",t.isDeleting),m(),d("ngIf",t.isDeleting),m(),d("ngIf",!t.isDeleting)}}function ne(e,i){e&1&&(r(0,"tr")(1,"td",15),o(2,"No departments found"),n()())}var x=class e{constructor(i){this.departmentService=i}departments=[];ngOnInit(){this.departmentService.getAll().subscribe(i=>this.departments=i)}deleteDepartment(i){let t=this.departments.find(a=>a.id===i);t.isDeleting=!0,this.departmentService.delete(i).subscribe(()=>this.departments=this.departments.filter(a=>a.id!==i))}static \u0275fac=function(t){return new(t||e)(p(_))};static \u0275cmp=v({type:e,selectors:[["ng-component"]],standalone:!1,decls:23,vars:2,consts:[[1,"p-4"],[1,"container"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"table-responsive"],[1,"table","table-striped"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"text-right"],["routerLink","/departments/add",1,"btn","btn-primary"],[1,"btn","btn-sm","btn-primary","mr-1",3,"routerLink"],[1,"btn","btn-sm","btn-danger",3,"click","disabled"],["class","spinner-border spinner-border-sm",4,"ngIf"],[1,"spinner-border","spinner-border-sm"],["colspan","3",1,"text-center"]],template:function(t,a){t&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),o(4,"Departments"),n(),r(5,"div",4)(6,"div",5)(7,"table",6)(8,"thead")(9,"tr")(10,"th"),o(11,"Name"),n(),r(12,"th"),o(13,"Description"),n(),r(14,"th"),o(15,"Employee Count"),n(),c(16,"th"),n()(),r(17,"tbody"),s(18,ie,13,9,"tr",7)(19,ne,3,0,"tr",8),n()()(),r(20,"div",9)(21,"a",10),o(22,"Add Department"),n()()()()()()),t&2&&(m(18),d("ngForOf",a.departments),m(),d("ngIf",!(a.departments!=null&&a.departments.length)))},dependencies:[j,S,C],encapsulation:2})};var re=e=>({"is-invalid":e});function oe(e,i){e&1&&(r(0,"div"),o(1,"Name is required"),n())}function ae(e,i){if(e&1&&(r(0,"div",13),s(1,oe,2,0,"div",14),n()),e&2){let t=h();m(),d("ngIf",t.f.name.errors.required)}}var u=class e{constructor(i,t,a,I,F){this.formBuilder=i;this.route=t;this.router=a;this.departmentService=I;this.alertService=F}form;id;isAddMode;ngOnInit(){this.id=Number(this.route.snapshot.params.id),this.isAddMode=!this.id,this.form=this.formBuilder.group({name:["",w.required],description:[""]}),this.isAddMode||this.departmentService.getById(this.id).subscribe(i=>this.form.patchValue(i))}get f(){return this.form.controls}onSubmit(){this.form.invalid||(this.isAddMode?this.createDepartment():this.updateDepartment())}createDepartment(){this.departmentService.create(this.form.value).subscribe({next:()=>{this.alertService.success("Department created successfully",{keepAfterRouteChange:!0}),this.router.navigate(["/departments"])},error:i=>this.alertService.error(i)})}updateDepartment(){this.departmentService.update(this.id,this.form.value).subscribe({next:()=>{this.alertService.success("Department updated successfully",{keepAfterRouteChange:!0}),this.router.navigate(["/departments"])},error:i=>this.alertService.error(i)})}static \u0275fac=function(t){return new(t||e)(p($),p(H),p(J),p(_),p(K))};static \u0275cmp=v({type:e,selectors:[["ng-component"]],standalone:!1,decls:21,vars:7,consts:[[1,"p-4"],[1,"container"],[1,"card"],[1,"card-header"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"form-group"],["type","text","formControlName","name",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["formControlName","description",1,"form-control"],[1,"text-center"],["type","submit",1,"btn","btn-primary","mr-1",3,"disabled"],["routerLink","/departments",1,"btn","btn-secondary"],[1,"invalid-feedback"],[4,"ngIf"]],template:function(t,a){t&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),o(4),n(),r(5,"div",4)(6,"form",5),g("ngSubmit",function(){return a.onSubmit()}),r(7,"div",6)(8,"label"),o(9,"Name"),n(),c(10,"input",7),s(11,ae,2,1,"div",8),n(),r(12,"div",6)(13,"label"),o(14,"Description"),n(),c(15,"textarea",9),n(),r(16,"div",10)(17,"button",11),o(18,"Save"),n(),r(19,"a",12),o(20,"Cancel"),n()()()()()()()),t&2&&(m(4),l(a.isAddMode?"Add Department":"Edit Department"),m(2),d("formGroup",a.form),m(4),d("ngClass",D(5,re,a.f.name.touched&&a.f.name.errors)),m(),d("ngIf",a.f.name.touched&&a.f.name.errors),m(6),d("disabled",a.form.invalid))},dependencies:[k,S,B,O,G,V,q,P,C],encapsulation:2})};var me=[{path:"",component:x,canActivate:[y]},{path:"add",component:u,canActivate:[y],data:{roles:["Admin"]}},{path:"edit/:id",component:u,canActivate:[y],data:{roles:["Admin"]}}],E=class e{static \u0275fac=function(t){return new(t||e)};static \u0275mod=b({type:e});static \u0275inj=f({imports:[A.forChild(me),A]})};var Q=class e{static \u0275fac=function(t){return new(t||e)};static \u0275mod=b({type:e});static \u0275inj=f({imports:[T,z,E]})};export{Q as DepartmentsModule};
