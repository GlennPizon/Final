import{c as W}from"./chunk-LKLDYXYD.js";import"./chunk-AKWIFSH2.js";import{b as x,c as Q}from"./chunk-VP6CFJRX.js";import{A as i,Aa as N,B as t,C as l,E as T,F as c,G as F,H as r,I as b,L as q,N as u,U as R,V as L,W as h,Z as P,ea as k,fa as p,ga as O,ha as j,ia as D,k as _,ka as U,na as B,o as E,oa as G,pa as V,qa as $,s as d,sa as z,t as f,ta as H,u as S,v as C,va as J,w as s,xa as K,y as m,ya as A,z as M}from"./chunk-Y3NWWHFQ.js";function ne(e,o){if(e&1&&(i(0,"tr")(1,"td"),r(2),t(),i(3,"td"),r(4),t(),i(5,"td"),r(6),t(),i(7,"td"),r(8),t(),i(9,"td",7)(10,"a",8),r(11,"Edit"),t()()()),e&2){let a=o.$implicit;d(2),q("",a.title," ",a.firstName," ",a.lastName,""),d(2),b(a.email),d(),M("color",a.status==="InActive"?"red":"blue"),d(),b(a.status),d(2),b(a.role),d(2),F("routerLink","edit/",a.id,"")}}function re(e,o){e&1&&(i(0,"tr")(1,"td",9),l(2,"span",10),t()())}var y=class e{constructor(o){this.accountService=o}accounts;ngOnInit(){this.accountService.getAll().pipe(_()).subscribe(o=>this.accounts=o)}deleteAccount(o){let a=this.accounts.find(n=>n.id===o);a.isDeleting=!0,this.accountService.delete(o).pipe(_()).subscribe(()=>{this.accounts=this.accounts.filter(n=>n.id!==o)})}static \u0275fac=function(a){return new(a||e)(f(x))};static \u0275cmp=S({type:e,selectors:[["ng-component"]],standalone:!1,decls:21,vars:2,consts:[["routerLink","add",1,"btn","btn-sm","btn-success","mb-2"],[1,"table","table-striped"],[2,"width","30%"],[2,"width","20%"],[2,"width","10%"],[4,"ngFor","ngForOf"],[4,"ngIf"],[2,"white-space","nowrap"],[1,"btn","btn-sm","btn-primary","mr-1",3,"routerLink"],["colspan","4",1,"text-center"],[1,"spinner-border","spinner-border-lg","align-center"]],template:function(a,n){a&1&&(i(0,"h1"),r(1,"Accounts"),t(),i(2,"p"),r(3,"All accounts from secure (admin only) api end point:"),t(),i(4,"a",0),r(5,"Create Account"),t(),i(6,"table",1)(7,"thead")(8,"tr")(9,"th",2),r(10,"Name"),t(),i(11,"th",2),r(12,"Email"),t(),i(13,"th",3),r(14,"Status"),t(),i(15,"th",3),r(16,"Role"),t(),l(17,"th",4),t()(),i(18,"tbody"),s(19,ne,12,10,"tr",5)(20,re,3,0,"tr",6),t()()),a&2&&(d(19),m("ngForOf",n.accounts),d(),m("ngIf",!n.accounts))},dependencies:[L,h,A],encapsulation:2})};var v=e=>({"is-invalid":e});function oe(e,o){e&1&&(i(0,"h1"),r(1,"Create Account"),t())}function ae(e,o){e&1&&(i(0,"h1"),r(1,"Edit Account"),t())}function de(e,o){e&1&&(i(0,"div"),r(1,"Title is required"),t())}function me(e,o){if(e&1&&(i(0,"div",28),s(1,de,2,0,"div",0),t()),e&2){let a=c();d(),m("ngIf",a.f.title.errors.required)}}function se(e,o){e&1&&(i(0,"div"),r(1,"First Name is required"),t())}function le(e,o){if(e&1&&(i(0,"div",28),s(1,se,2,0,"div",0),t()),e&2){let a=c();d(),m("ngIf",a.f.firstName.errors.required)}}function pe(e,o){e&1&&(i(0,"div"),r(1,"Last Name is required"),t())}function ce(e,o){if(e&1&&(i(0,"div",28),s(1,pe,2,0,"div",0),t()),e&2){let a=c();d(),m("ngIf",a.f.lastName.errors.required)}}function ue(e,o){e&1&&(i(0,"div"),r(1,"Email is required"),t())}function fe(e,o){e&1&&(i(0,"div"),r(1,"Email must be a valid email address"),t())}function ve(e,o){if(e&1&&(i(0,"div",28),s(1,ue,2,0,"div",0)(2,fe,2,0,"div",0),t()),e&2){let a=c();d(),m("ngIf",a.f.email.errors.required),d(),m("ngIf",a.f.email.errors.email)}}function _e(e,o){e&1&&(i(0,"div"),r(1,"Role is required"),t())}function ge(e,o){if(e&1&&(i(0,"div",28),s(1,_e,2,0,"div",0),t()),e&2){let a=c();d(),m("ngIf",a.f.role.errors.required)}}function Ee(e,o){e&1&&(i(0,"div"),r(1,"Status is required"),t())}function Se(e,o){if(e&1&&(i(0,"div",28),s(1,Ee,2,0,"div",0),t()),e&2){let a=c();d(),m("ngIf",a.f.status.errors.required)}}function Ce(e,o){e&1&&(i(0,"div")(1,"h3",29),r(2,"Change Password"),t(),i(3,"p"),r(4,"Leave blank to keep the same password"),t()())}function be(e,o){e&1&&(i(0,"div"),r(1,"Password is required"),t())}function he(e,o){e&1&&(i(0,"div"),r(1,"Password must be at least 6 characters"),t())}function Ae(e,o){if(e&1&&(i(0,"div",28),s(1,be,2,0,"div",0)(2,he,2,0,"div",0),t()),e&2){let a=c();d(),m("ngIf",a.f.password.errors.required),d(),m("ngIf",a.f.password.errors.minlength)}}function xe(e,o){e&1&&(i(0,"div"),r(1,"Confirm Password is required"),t())}function ye(e,o){e&1&&(i(0,"div"),r(1,"Passwords must match"),t())}function Ie(e,o){if(e&1&&(i(0,"div",28),s(1,xe,2,0,"div",0)(2,ye,2,0,"div",0),t()),e&2){let a=c();d(),m("ngIf",a.f.confirmPassword.errors.required),d(),m("ngIf",a.f.confirmPassword.errors.mustMatch)}}function Ne(e,o){e&1&&l(0,"span",30)}var g=class e{constructor(o,a,n,Y,Me){this.formBuilder=o;this.route=a;this.router=n;this.accountService=Y;this.alertService=Me}form;id;isAddMode;loading=!1;submitted=!1;ngOnInit(){this.id=this.route.snapshot.params.id,this.isAddMode=!this.id,this.form=this.formBuilder.group({title:["",p.required],firstName:["",p.required],lastName:["",p.required],email:["",[p.required,p.email]],role:["User",p.required],password:["",[p.minLength(6),this.isAddMode?p.required:p.nullValidator]],confirmPassword:[""],status:["InActive"]},{validator:W("password","confirmPassword")}),this.isAddMode||this.accountService.getById(this.id).pipe(_()).subscribe(o=>this.form.patchValue(o))}get f(){return this.form.controls}onSubmit(){this.submitted=!0,this.alertService.clear(),!this.form.invalid&&(this.loading=!0,this.isAddMode?this.createAccount():this.updateAccount())}createAccount(){this.accountService.create(this.form.value).pipe(_()).subscribe({next:()=>{this.alertService.success("Account created successfully",{keepAfterRouteChange:!0}),this.router.navigate(["../"],{relativeTo:this.route})},error:o=>{this.alertService.error(o),this.loading=!1}})}updateAccount(){this.accountService.update(this.id,this.form.value).pipe(_()).subscribe({next:()=>{this.alertService.success("Update successful",{keepAfterRouteChange:!0}),this.router.navigate(["../../"],{relativeTo:this.route})},error:o=>{this.alertService.error(o),this.loading=!1}})}static \u0275fac=function(a){return new(a||e)(f(z),f(J),f(K),f(x),f(Q))};static \u0275cmp=S({type:e,selectors:[["ng-component"]],standalone:!1,decls:71,vars:38,consts:[[4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"form-row"],[1,"form-group","col"],["formControlName","title",1,"form-control",3,"ngClass"],["value",""],["value","Mr"],["value","Mrs"],["value","Miss"],["value","Ms"],["class","invalid-feedback",4,"ngIf"],[1,"form-group","col-5"],["type","text","formControlName","firstName",1,"form-control",3,"ngClass"],["type","text","formControlName","lastName",1,"form-control",3,"ngClass"],[1,"form-group","col-7"],["type","text","formControlName","email",1,"form-control",3,"ngClass"],["formControlName","role",1,"form-control",3,"ngClass"],["value","User"],["value","Admin"],["formControlName","status",1,"form-control",3,"ngClass"],["value","Active"],["value","InActive"],["type","password","formControlName","password",1,"form-control",3,"ngClass"],["type","password","formControlName","confirmPassword",1,"form-control",3,"ngClass"],[1,"form-group"],[1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm mr-1",4,"ngIf"],["routerLink","/admin/accounts",1,"btn","btn-link"],[1,"invalid-feedback"],[1,"pt-3"],[1,"spinner-border","spinner-border-sm","mr-1"]],template:function(a,n){a&1&&(s(0,oe,2,0,"h1",0)(1,ae,2,0,"h1",0),i(2,"form",1),T("ngSubmit",function(){return n.onSubmit()}),i(3,"div",2)(4,"div",3)(5,"label"),r(6,"Title"),t(),i(7,"select",4),l(8,"option",5),i(9,"option",6),r(10,"Mr"),t(),i(11,"option",7),r(12,"Mrs"),t(),i(13,"option",8),r(14,"Miss"),t(),i(15,"option",9),r(16,"Ms"),t()(),s(17,me,2,1,"div",10),t(),i(18,"div",11)(19,"label"),r(20,"First Name"),t(),l(21,"input",12),s(22,le,2,1,"div",10),t(),i(23,"div",11)(24,"label"),r(25,"Last Name"),t(),l(26,"input",13),s(27,ce,2,1,"div",10),t()(),i(28,"div",2)(29,"div",14)(30,"label"),r(31,"Email"),t(),l(32,"input",15),s(33,ve,3,2,"div",10),t(),i(34,"div",3)(35,"label"),r(36,"Role"),t(),i(37,"select",16),l(38,"option",5),i(39,"option",17),r(40,"User"),t(),i(41,"option",18),r(42,"Admin"),t()(),s(43,ge,2,1,"div",10),t(),i(44,"div",3)(45,"label"),r(46,"Status"),t(),i(47,"select",19)(48,"option",20),r(49,"Active"),t(),i(50,"option",21),r(51,"InActive"),t()(),s(52,Se,2,1,"div",10),t()(),s(53,Ce,5,0,"div",0),i(54,"div",2)(55,"div",3)(56,"label"),r(57,"Password"),t(),l(58,"input",22),s(59,Ae,3,2,"div",10),t(),i(60,"div",3)(61,"label"),r(62,"Confirm Password"),t(),l(63,"input",23),s(64,Ie,3,2,"div",10),t()(),i(65,"div",24)(66,"button",25),s(67,Ne,1,0,"span",26),r(68," Save "),t(),i(69,"a",27),r(70,"Cancel"),t()()()),a&2&&(m("ngIf",n.isAddMode),d(),m("ngIf",!n.isAddMode),d(),m("formGroup",n.form),d(5),m("ngClass",u(22,v,n.submitted&&n.f.title.errors)),d(10),m("ngIf",n.submitted&&n.f.title.errors),d(4),m("ngClass",u(24,v,n.submitted&&n.f.firstName.errors)),d(),m("ngIf",n.submitted&&n.f.firstName.errors),d(4),m("ngClass",u(26,v,n.submitted&&n.f.lastName.errors)),d(),m("ngIf",n.submitted&&n.f.lastName.errors),d(5),m("ngClass",u(28,v,n.submitted&&n.f.email.errors)),d(),m("ngIf",n.submitted&&n.f.email.errors),d(4),m("ngClass",u(30,v,n.submitted&&n.f.role.errors)),d(6),m("ngIf",n.submitted&&n.f.role.errors),d(4),m("ngClass",u(32,v,n.submitted&&n.f.status.errors)),d(5),m("ngIf",n.submitted&&n.f.status.errors),d(),m("ngIf",!n.isAddMode),d(5),m("ngClass",u(34,v,n.submitted&&n.f.password.errors)),d(),m("ngIf",n.submitted&&n.f.password.errors),d(4),m("ngClass",u(36,v,n.submitted&&n.f.confirmPassword.errors)),d(),m("ngIf",n.submitted&&n.f.confirmPassword.errors),d(2),m("disabled",n.loading),d(),m("ngIf",n.loading))},dependencies:[R,h,D,V,$,k,G,O,j,U,B,A],encapsulation:2})};var we=[{path:"",component:y},{path:"add",component:g},{path:"edit/:id",component:g}],I=class e{static \u0275fac=function(a){return new(a||e)};static \u0275mod=C({type:e});static \u0275inj=E({imports:[N.forChild(we),N]})};var X=class e{static \u0275fac=function(a){return new(a||e)};static \u0275mod=C({type:e});static \u0275inj=E({imports:[P,H,I]})};export{X as AccountsModule};
